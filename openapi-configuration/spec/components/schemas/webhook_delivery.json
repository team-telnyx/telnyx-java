{
  "description": "Record of all attempts to deliver a webhook.",
  "properties": {
    "id": {
      "description": "Uniquely identifies the webhook_delivery record.",
      "type": "string",
      "format": "uuid",
      "example": "f5586561-8ff0-4291-a0ac-84fe544797bd"
    },
    "user_id": {
      "description": "Uniquely identifies the user that owns the webhook_delivery record.",
      "type": "string",
      "format": "uuid",
      "example": "0ccc7b54-4df3-4bca-a65a-3da1ecc777f0"
    },
    "record_type": {
      "description": "Identifies the type of the resource.",
      "type": "string",
      "example": "webhook_delivery"
    },
    "status": {
      "description": "Delivery status: 'delivered' when successfuly delivered or 'failed' if all attempts have failed.",
      "enum": [
        "delivered",
        "failed"
      ],
      "type": "string"
    },
    "webhook": {
      "description": "Original webhook JSON data. Payload fields vary according to event type.",
      "type": "object",
      "properties": {
        "record_type": {
          "type": "string",
          "example": "event",
          "enum": [
            "event"
          ],
          "description": "Identifies the type of the resource."
        },
        "event_type": {
          "type": "string",
          "example": "webhook.command",
          "description": "The type of event being delivered."
        },
        "id": {
          "type": "string",
          "format": "uuid",
          "example": "0ccc7b54-4df3-4bca-a65a-3da1ecc777f0",
          "description": "Identifies the type of resource."
        },
        "occurred_at": {
          "type": "string",
          "format": "date-time",
          "example": "2018-02-02T22:25:27.521992Z",
          "description": "ISO 8601 datetime of when the event occurred."
        },
        "payload": {
          "type": "object",
          "properties": {}
        }
      },
      "example": {
        "record_type": "event",
        "id": "C9C0797E-901D-4349-A33C-C2C8F31A92C2",
        "event_type": "call_initiated",
        "occurred_at": "2020-08-10T13:02:01.000Z",
        "payload": {
          "useful": "information"
        }
      }
    },
    "started_at": {
      "description": "ISO 8601 timestamp indicating when the first request attempt was initiated.",
      "type": "string",
      "format": "date-time",
      "example": "2020-08-10T14:00:00.000Z"
    },
    "finished_at": {
      "description": "ISO 8601 timestamp indicating when the last webhook response has been received.",
      "type": "string",
      "format": "date-time",
      "example": "2020-08-10T14:00:05.595Z"
    },
    "attempts": {
      "description": "Detailed delivery attempts, ordered by most recent.",
      "type": "array",
      "items": {
        "$ref": "./attempt.json"
      },
      "example": [
        {
          "status": "delivered",
          "started_at": "2020-08-10T14:00:05.364Z",
          "finished_at": "2020-08-10T14:00:05.595Z",
          "http": {
            "request": {
              "url": "https://fallback.example.com/webhooks",
              "headers": [
                "Accept: */*"
              ]
            },
            "response": {
              "status": 200,
              "headers": [
                "Content-Type: text/html"
              ],
              "body": "All good."
            }
          }
        },
        {
          "status": "failed",
          "started_at": "2020-08-10T14:00:05.004Z",
          "finished_at": "2020-08-10T14:00:05.360Z",
          "http": {
            "request": {
              "url": "https://typo.example.com/webhooks",
              "headers": [
                "Accept: */*"
              ]
            },
            "response": {
              "status": 404,
              "headers": [
                "Content-Type: text/html",
                "Pragma: no-cache"
              ],
              "body": "Oops. Not found."
            }
          },
          "errors": [
            {
              "code": "75499",
              "title": "Webhook host returned HTTP 4XX",
              "detail": "The server returned another HTTP 4XX error"
            }
          ]
        }
      ]
    }
  }
}